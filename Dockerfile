FROM ubuntu:19.10 AS build
ENV build_cores 10
ARG http_proxy
ENV http_proxy=${http_proxy}
ENV https_proxy=${http_proxy}

RUN sed -Ei 's/^# deb-src /deb-src /' /etc/apt/sources.list \
    && apt-get update \
    && apt-get install adwaita-icon-theme autoconf automake autopoint autotools-dev binutils binutils-common binutils-x86-64-linux-gnu bsdmainutils build-essential clamz cmake cmake-data cpp cpp-9 debhelper dh-autoreconf dh-strip-nondeterminism diffstat docbook-xml docbook-xsl dpkg-dev file fontconfig fontconfig-config fonts-dejavu-core g++ g++-9 gcc gcc-9 gcc-9-base gettext gettext-base gir1.2-atk-1.0 gir1.2-freedesktop gir1.2-gdkpixbuf-2.0 gir1.2-glib-2.0 gir1.2-gtk-2.0 gir1.2-harfbuzz-0.0 gir1.2-pango-1.0 groff-base gtk-update-icon-cache hicolor-icon-theme humanity-icon-theme icu-devtools intltool-debian iso-codes libaio-dev libaio1 libapt-pkg-perl libarchive-zip-perl libarchive13 libasan4 libasn1-8-heimdal libasyncns0 libatk1.0-0 libatk1.0-data libatk1.0-dev libatomic1 libaudio2 libavahi-client3 libavahi-common-data libavahi-common3 libavcodec-dev libavcodec58 libavformat-dev libavformat58 libavutil-dev libavutil56 libbinutils libbluray2 libbsd0 libc-dev-bin libc6-dev libcairo-gobject2 libcairo-script-interpreter2 libcairo2 libcairo2-dev libcap2 libcap2-bin libcc1-0 libcgi-pm-perl libchromaprint1 libcilkrts5 libclass-accessor-perl libclone-perl libclucene-core1v5 libcroco3 libcrystalhd3 libcups2 libcurl3-gnutls libcurl4 libcurl4-gnutls-dev libdatrie1 libdbus-1-3 libdbusmenu-qt5-dev libdigest-hmac-perl libdlrestrictions1 libdpkg-perl libdrm-amdgpu1 libdrm-common libdrm-dev libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libdrm2 libedit2 libegl-mesa0 libegl1 libelf1 libemail-valid-perl libevent-2.1-6 libexiv2-14 libexpat1 libexpat1-dev libexporter-tiny-perl libfftw3-bin libfftw3-dev libfftw3-double3 libfftw3-long3 libfftw3-quad3 libfftw3-single3 libfile-basedir-perl libfile-stripnondeterminism-perl libflac8 libfontconfig1 libfontconfig1-dev libfreetype6 libfreetype6-dev libgbm1 libgcc-7-dev libgcrypt20-dev libgdbm-compat4 libgdbm6 libgdk-pixbuf2.0-0 libgdk-pixbuf2.0-common libgdk-pixbuf2.0-dev libgif7 libgirepository-1.0-1 libgl1 libgl1-mesa-dev libgl1-mesa-dri libgl1-mesa-glx libglapi-mesa libgles1 libgles2 libglib2.0-0 libglib2.0-bin libglib2.0-data libglib2.0-dev libglib2.0-dev-bin libglu1-mesa libglu1-mesa-dev libglvnd-core-dev libglvnd-dev libglvnd0 libglx-mesa0 libglx0 libgme0 libgmp-dev libgmpxx4ldbl libgnutls-dane0 libgnutls-openssl27 libgnutls28-dev libgnutlsxx28 libgomp1 libgpg-error-dev libgpod-dev libgpod4 libgraphite2-3 libgraphite2-dev libgsm1 libgssapi-krb5-2 libgssapi3-heimdal libgstreamer-plugins-base1.0-0 libgstreamer1.0-0 libgtk2.0-0 libgtk2.0-common libgtk2.0-dev libharfbuzz-dev libharfbuzz-gobject0 libharfbuzz-icu0 libharfbuzz0b libhcrypto4-heimdal libheimbase1-heimdal libheimntlm0-heimdal libhtml-parser-perl libhtml-tagset-perl libhx509-5-heimdal libice-dev libice6 libicu-dev libicu-le-hb-dev libicu-le-hb0 libicu63 libidn11 libidn11-dev libidn2-0-dev libidn2-dev libifp-dev libifp4 libimobiledevice-dev libimobiledevice6 libio-pty-perl libio-socket-inet6-perl libio-socket-ssl-perl libio-string-perl libipc-run-perl libipc-system-simple-perl libisl21 libitm1 libjbig0 libjpeg-turbo8 libjpeg8 libjsoncpp1 libk5crypto3 libkf5kcmutils-dev libkeyutils1  libkmod2 libkrb5-26-heimdal libkrb5-3 libkrb5support0 liblastfm-dev liblastfm-fingerprint1 liblastfm1 liblcms2-2 libldap-2.4-2 libldap-common liblist-moreutils-perl libllvm8 liblocale-gettext-perl libloudmouth1-0 libloudmouth1-dev liblsan0 libltdl7 liblz4-dev liblzo2-2 libmagic-mgc libmagic1 libmailtools-perl libmhash2 libmng2 libmp3lame0 libmpc3 libmpdec2 libmpfr6 libmpg123-0 libmpx2 libmtp-common libmtp-dev libmtp9 libmygpo-qt-dev libmygpo-qt-dev libmariadbclient-dev libmariadbd19 libmariadbd-dev libnet-dns-perl libnet-domain-tld-perl libnet-ip-perl libnet-smtp-ssl-perl libnet-ssleay-perl libnghttp2-14 libnjb-dev libnjb5 libnuma-dev libnuma1 libofa0 libofa0-dev libogg0 libopengl0 libopenjp2-7 libopenmpt0 libopus0 liborc-0.4-0 libp11-kit-dev libpango-1.0-0 libpango1.0-dev libpangocairo-1.0-0 libpangoft2-1.0-0 libpangoxft-1.0-0 libparse-debianchangelog-perl libpciaccess0 libpcre16-3 libpcre3-dev libpcre32-3 libpcrecpp0v5 libperl5.28 libphonon-dev libphonon4 libpipeline1 libpixman-1-0 libpixman-1-dev libplist-dev libplist3 libpng-dev libpng16-16 libpsl5 libpthread-stubs0-dev libpulse-mainloop-glib0 libpulse0 libpython3-stdlib libqca2 libqca2-dev libqt4-dbus libqt4-declarative libqt4-designer libqt4-dev libqt4-dev-bin libqt4-help libqt4-network libqt4-opengl libqt4-opengl-dev libqt4-qt3support libqt4-script libqt4-scripttools libqt4-sql libqt4-svg libqt4-test libqt4-xml libqt4-xmlpatterns libqtcore4 libqtdbus4 libqtgui4 libqtwebkit-dev libqtwebkit4 libquadmath0 libraptor2-0 librasqal3 librdf0 libreadline8 librhash0 libroken18-heimdal librsvg2-2 librsvg2-common librtmp1 libsamplerate0 libsasl2-2 libsasl2-modules-db libsensors5 libshine3 libsigsegv2 libsm-dev libsm6 libsnappy1v5 libsndfile1 libsocket6-perl libsoxr0 libspeex1 libsqlite3-0 libssh-gcrypt-4 libssl-dev libssl1.1 libstdc++-7-dev libsub-name-perl libswresample-dev libavresample4 libtag-extras-dev libtag-extras1 libtag1-dev libtag1v5 libtag1v5-vanilla libtasn1-6-dev libtext-levenshtein-perl libthai-data libthai0 libtheora0 libtiff5 libtimedate-perl libtool libtsan0 libtwolame0 libubsan0 libunbound8 liburi-perl libusb-0.1-4 libusb-1.0-0 libusb-1.0-0-dev libusb-dev libusbmuxd-dev libusbmuxd4 libutempter0 libuv1 libva-drm2 libva-x11-2 libva2 libvdpau1 libvorbis0a libvorbisenc2 libvorbisfile3 libvpx6 libwavpack1 libwayland-client0 libwayland-server0 libwebp6 libwebpmux3 libwind0-heimdal libwrap0 libwrap0-dev libx11-6 libx11-data libx11-dev libx11-xcb-dev libx11-xcb1 libx264-155 libxau-dev libxau6 libxcb-dri2-0 libxcb-dri2-0-dev libxcb-dri3-0 libxcb-dri3-dev libxcb-glx0 libxcb-glx0-dev libxcb-present-dev libxcb-present0 libxcb-randr0 libxcb-randr0-dev libxcb-render0 libxcb-render0-dev libxcb-shape0 libxcb-shape0-dev libxcb-shm0 libxcb-shm0-dev libxcb-sync-dev libxcb-sync1 libxcb-xfixes0 libxcb-xfixes0-dev libxcb1 libxcb1-dev libxcomposite-dev libxcomposite1 libxcursor-dev libxcursor1 libxdamage-dev libxdamage1 libxdmcp-dev libxdmcp6 libxext-dev libxext6 libxfixes-dev libxfixes3 libxft-dev libxft2 libxi-dev libxi6 libxinerama-dev libxinerama1 libxml-libxml-perl libxml-namespacesupport-perl libxml-sax-base-perl libxml-sax-perl libxml-simple-perl libxml2 libxml2-dev libxml2-utils libxmuu1 libxrandr-dev libxrandr2 libxrender-dev libxrender1 libxshmfence-dev libxshmfence1 libxslt1.1 libxss1 libxt6 libxvidcore4 libxxf86vm-dev libxxf86vm1 libyajl2 libyaml-0-2 libyaml-libyaml-perl libzvbi-common libzvbi0 lintian linux-libc-dev m4 make man-db mesa-common-dev mime-support mysql-common mariadb-server-core-10.3 netbase nettle-dev patch patchutils perl perl-modules-5.28 perl-openssl-defaults phonon-backend-null pkg-config pkg-kde-tools po-debconf python3 python3-distutils python3-lib2to3 python3-minimal python3.7 qdbus qt4-linguist-tools qt4-qmake qtchooser qtcore4-l10n readline-common sgml-base sgml-data shared-mime-info t1utils ubuntu-mono ucf udev x11-common x11proto-composite-dev x11proto-core-dev x11proto-damage-dev x11proto-dev x11proto-fixes-dev x11proto-input-dev x11proto-randr-dev x11proto-xext-dev x11proto-xf86vidmode-dev x11proto-xinerama-dev xauth xml-core xorg-sgml-doctools xtrans-dev xz-utils zlib1g-dev -y \
    && DEBIAN_FRONTEND=noninteractive apt-get install git wget unzip libkf5archive-dev libkf5attica-dev libkf5codecs-dev libkf5config-dev libkf5configwidgets-dev libkf5coreaddons-dev libkf5crash-dev libkf5dbusaddons-dev libkf5declarative-dev libkf5dnssd-dev libkf5globalaccel-dev libkf5guiaddons-dev libkf5i18n-dev libkf5iconthemes-dev libkf5kcmutils-dev libkf5kio-dev libkf5newstuff-dev libkf5notifications-dev libkf5notifyconfig-dev libkf5package-dev libkf5solid-dev libkf5texteditor-dev libkf5threadweaver-dev libkf5widgetsaddons-dev libkf5windowsystem-dev kirigami2-dev qtquickcontrols2-5-dev qtwebengine5-dev libphonon4qt5-dev libqt5svg5-dev qtscript5-dev qtbase5-dev qtdeclarative5-dev build-essential cmake extra-cmake-modules pkg-config libmariadb-dev mariadb-client mariadb-server libmariadb-dev-compat libkf5wallet-dev -y

COPY container-scripts/build.sh build.sh

RUN chmod +x build.sh

RUN mkdir /build

VOLUME [ "/build" ]
